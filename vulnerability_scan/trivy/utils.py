from .serializers import *
from .status import *


def check_image_scan_existence(data):

    organization=data['organization']
    image_uri=data['image_uri']

    image_data= get_trivy_image_details(organization=organization,image_uri=image_uri)

    if len(image_data) == 0 :
        print("image Does not Exists")

        data={
            "message": "{}".format(STATE[1000]),
            "statuscode":1000,
            "image_uri":"{}".format(image_uri)
        }
        return data
    else:
        print("image Already Exists")
        data={
            "message": "{}".format(STATE[image_data["statuscode"]]),
            "statuscode":image_data["statuscode"],
            "image_uri":"{}".format(image_uri)
        }
        return data